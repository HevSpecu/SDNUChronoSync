---
import DashboardLayout from '../../layouts/DashboardLayout.astro';
const title = '团队视图';
const description = '查看所有团队的聚合课表';
---

<DashboardLayout title={title} description={description}>
  <div id="all-teams-view-app"></div>

  <script>
    import { createApp } from 'vue';
    import { createPinia } from 'pinia';
    import AllTeamsViewPage from '@/components/AllTeamsViewPage.vue';

  // Resolve team ID from query (?teamId=) or path (/dashboard/team-view/:id)
  const urlParams = new URLSearchParams(window.location.search);
  const queryTeamId = urlParams.get('teamId');
  const pathSegments = window.location.pathname.split('/').filter(Boolean);
  const lastSegment = pathSegments[pathSegments.length - 1];
  const pathTeamId = /^\d+$/.test(lastSegment) ? parseInt(lastSegment) : undefined;
  const preselectedTeamId = queryTeamId ? parseInt(queryTeamId) : pathTeamId;

    // Create Vue app
    const pinia = createPinia();
    const app = createApp(AllTeamsViewPage, {
      preselectedTeamId: preselectedTeamId
    });
    app.use(pinia);

    // Mount when DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
      app.mount('#all-teams-view-app');
    });
  </script>
</DashboardLayout>